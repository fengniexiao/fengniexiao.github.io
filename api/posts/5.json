{"title":"python 数据清洗","slug":"python数据清洗","date":"2020-06-26","updated":"2020-06-26","comments":true,"path":"api/posts/5.json","excerpt":"<ul><li> 数据清理或清除是指从一个记录集、表或是数据库中检测和修改（或删除）损坏或不准确的数据记录的过程，它用于识别数据中不完整的、不正确的、不准确的或者与项目本身不相关的部分，然后对这些无效的数据进行替换、修改或者删除等操作。</li></ul>","cover":null,"covers":null,"content":"<ul><li>数据清理或清除是指从一个记录集、表或是数据库中检测和修改（或删除）损坏或不准确的数据记录的过程，它用于识别数据中不完整的、不正确的、不准确的或者与项目本身不相关的部分，然后对这些无效的数据进行替换、修改或者删除等操作。</li></ul><a id=\"more\"></a><h1>数据查看, 了解数据 </h1><p> 对数据进行多方位的查看：<br>实际情况中可能会有很多行，一般用 head()看数据基本情况 </p><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">data.head()  #查看长啥样</span><br><span class=\"line\">data.shape  #查看数据的行列大小</span><br><span class=\"line\">data.info() #查看索引、数据类型和内存信息</span><br><span class=\"line\">data.describe() #查看每列数据的基本统计值，包括计数值、均值、标准差、最小最大值、1&#x2F;4、1&#x2F;2、3&#x2F;4 分位数</span><br><span class=\"line\"># 如果上面这些操作还不够的话，就作图，先导入 Python 可视化库 matplotlib</span><br></pre></td></tr></table></figure><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># 列级别的判断, 但凡某一列有 null 值或空的，则为真</span><br><span class=\"line\">data.isnull().any()</span><br><span class=\"line\"></span><br><span class=\"line\"># 将列中为空或者 null 的个数统计出来，并将缺失值最多的排前</span><br><span class=\"line\">total &#x3D; data.isnull().sum().sort_values(ascending&#x3D;False)</span><br><span class=\"line\">print(total)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"># 输出百分比：</span><br><span class=\"line\">percent &#x3D;(data.isnull().sum()&#x2F;data.isnull().count()).sort_values(ascending&#x3D;False)</span><br><span class=\"line\">missing_data &#x3D; pd.concat([total, percent], axis&#x3D;1, keys&#x3D;[&#39;Total&#39;, &#39;Percent&#39;])</span><br><span class=\"line\">missing_data.head(20)</span><br></pre></td></tr></table></figure><p> 也可以从视觉上直观查看缺失值 </p><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">import missingno</span><br><span class=\"line\">missingno.matrix(data)</span><br><span class=\"line\">data&#x3D;data.dropna(thresh&#x3D;data.shape[0]*0.5,axis&#x3D;1)  #至少有一半以上是非空的列筛选出来</span><br><span class=\"line\"># 如果某一行全部都是 na 才删除：</span><br><span class=\"line\">data.dropna(axis&#x3D;0,how&#x3D;&#39;all&#39;)</span><br></pre></td></tr></table></figure><h1> 默认情况下是只保留没有空值的行 </h1><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">data&#x3D;data.dropna(axis&#x3D;0)</span><br></pre></td></tr></table></figure><h1> 统计重复记录数 </h1><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">data.duplicated().sum()</span><br><span class=\"line\">data.drop_duplicates()</span><br></pre></td></tr></table></figure><h1> 数据处理 </h1><p> 删除某些行和列，可以用 data.drop() 方法 </p><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">df.drop(to_drop, axis&#x3D;1, inplace&#x3D;True)# 参数 axis 为 1 时代表列，为 0 时代表行，参数 inplace&#x3D;True 表示不创建新的对象，直接对原始对象进行修改</span><br></pre></td></tr></table></figure><p> 重新命名列 <br> 用.rename()方法进行修改 </p><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">new_names &#x3D; &#123;&#39; 旧 1&#39;: &#39; 新 1&#39;, &#39; 旧 2&#39;: &#39; 新 2&#39;, &#39; 旧 3&#39;: &#39; 新 3&#39;&#125;</span><br><span class=\"line\">df.rename(columns&#x3D;new_names, inplace&#x3D;True)</span><br></pre></td></tr></table></figure><p> 重新设置索引 <br> 数据默认的索引是从 0 开始的有序整数，但如果想把某一列设置为新的索引，可以用.set_index()方法实现 </p><p> 用字符串操作规范列 </p><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">str.lower() 是把大写转换成小写，同理，str.upper() 是把小写转换成大写，将示例中用大写字母表示的索引转换成小写 </span><br><span class=\"line\">.str.replace(&#39;$&#39;,&#39;￥&#39;)# 把美元换成人民币</span><br><span class=\"line\">str.strip() 去除字符串中的头尾空格</span><br><span class=\"line\">str.split(&#39;|&#39;) 使用字符串中的 &#39;|&#39; 字符作为分隔符</span><br><span class=\"line\">str.contains() 判断是否存在某个字符，返回的是布尔值</span><br><span class=\"line\">str.find() 检测字符串中是否包含子字符串 str，如果是，则返回该子字符串开始位置的索引值</span><br></pre></td></tr></table></figure><p> 删除重复数据 <br> 调用.drop_duplicates()函数删除重复数据 <br> 填充缺失值 <br> 可以调用 fillna()函数，用该列的均值.mean()填充 NaN 值 </p><p> 更多更详细的处理可参考<a href=\"https://baijiahao.baidu.com/s?id=1660712430385497444&amp;wfr=spider&amp;for=pc\" target=\"_blank\" rel=\"noopener external nofollow noreferrer\">2020 版 Python 数据清理终极指南</a></p>","url":"/posts/5/","min2read":3,"word4post":821,"prev_post":{"title":"链家二手房数据可视化","url":"/posts/7/"},"next_post":{"title":"python 爬虫同步 (一般)、并发 (多线程)、异步、框架 scrapy 使用","url":"/posts/4/"},"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" data-id=\"\" href = \"#\"><span class=\"toc-number\">1.</span> <span class=\"toc-text\">数据查看, 了解数据 </span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" data-id=\"\" href = \"#\"><span class=\"toc-number\">2.</span> <span class=\"toc-text\"> 默认情况下是只保留没有空值的行 </span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" data-id=\"\" href = \"#\"><span class=\"toc-number\">3.</span> <span class=\"toc-text\"> 统计重复记录数 </span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" data-id=\"\" href = \"#\"><span class=\"toc-number\">4.</span> <span class=\"toc-text\"> 数据处理 </span></a></li></ol>","categories":[{"name":"python","path":"api/categories/python.json","url":"/categories/python/"}],"tags":[{"name":"数据分析","path":"api/tags/数据分析.json","url":"/tags/数据分析/"}]}