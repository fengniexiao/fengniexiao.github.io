{"title":"OpenCV 截取指定坐标图","slug":"OpenCV截取指定坐标图","date":"2020-07-29","updated":"2020-07-29","comments":true,"path":"api/posts/64.json","excerpt":"<ul><li>转化规则 </li><li> 指定坐标位置的图像截取 </li><li> 批量处理—指定坐标位置的图像截取 </li><li> 添加多进程多进程（加快处理）</li></ul>","cover":"http://ww1.sinaimg.cn/large/e92dbddbgy1gh7v2muxscj20e7036dft.jpg","covers":["http://ww1.sinaimg.cn/large/e92dbddbgy1gh7v2muxscj20e7036dft.jpg"],"content":"<ul><li>转化规则 </li><li> 指定坐标位置的图像截取 </li><li> 批量处理—指定坐标位置的图像截取 </li><li> 添加多进程多进程（加快处理）</li></ul><a id=\"more\"></a><h1>转化规则 </h1><p><strong> 给出坐标数据如图 </strong><br><img src=\"http://ww1.sinaimg.cn/large/e92dbddbgy1gh7v2muxscj20e7036dft.jpg\" alt=\"112asd.png\"><br> 或<br><img src=\"http://ww1.sinaimg.cn/large/e92dbddbgy1gh7v3pbpnuj20dt063mxf.jpg\" alt=\"qwe2.png\"><br><img src=\"http://ww1.sinaimg.cn/large/e92dbddbgy1gh7v41ps1ij20su0bzq4d.jpg\" alt=\"3dfe.png\"></p><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">规则：</span><br><span class=\"line\">[x1,y1],[x2,y2], 原图 宽 w 高 h</span><br><span class=\"line\">x0 &#x3D; (x1+x2)&#x2F;2</span><br><span class=\"line\">y0 &#x3D; (y1+y2)&#x2F;2</span><br><span class=\"line\">wb &#x3D; |x2-x1|&#x2F;w</span><br><span class=\"line\">wh &#x3D; |y2-y1|&#x2F;h</span><br></pre></td></tr></table></figure><p><strong>需要转化为像素值且为整数 </strong><br><img src=\"http://ww1.sinaimg.cn/large/e92dbddbgy1gh7v4bxjsjj20gq01rjrd.jpg\" alt=\"tbrvv44.png\"></p><h1> 指定坐标位置的图像截取 </h1><p><strong> 导入相关库 </strong><br><img src=\"http://ww1.sinaimg.cn/large/e92dbddbgy1gh7v54hqvxj20bg04f3yh.jpg\" alt=\"btbgbrt5.png\"></p><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&quot;&quot;&quot;</span><br><span class=\"line\">filepath 源图像地址</span><br><span class=\"line\">destpath 调整后保存图像地址</span><br><span class=\"line\">&quot;&quot;&quot;</span><br><span class=\"line\"># 遍历指定目录，显示目录下的所有文件名</span><br><span class=\"line\">def CropImage4File(filepath,destpath):</span><br><span class=\"line\">    pathDir &#x3D;  os.listdir(filepath)    # 列出文件路径中的所有路径或文件</span><br><span class=\"line\">    for allDir in pathDir:</span><br><span class=\"line\">        child &#x3D; os.path.join(filepath, allDir)</span><br><span class=\"line\">        dest &#x3D; os.path.join(destpath,allDir)</span><br><span class=\"line\">        if os.path.isfile(child):</span><br><span class=\"line\">        \timage &#x3D; cv2.imread(child) </span><br><span class=\"line\">            sp &#x3D; image.shape            #获取图像形状：返回【行数值，列数值】列表</span><br><span class=\"line\">            sz1 &#x3D; sp[0]                 #图像的高度（行 范围）</span><br><span class=\"line\">            sz2 &#x3D; sp[1]                 #图像的宽度（列 范围）</span><br><span class=\"line\">            #sz3 &#x3D; sp[2]                #像素值由【RGB】三原色组成</span><br><span class=\"line\">            </span><br><span class=\"line\">            #你想对文件的操作</span><br><span class=\"line\">            a&#x3D;int(sz1&#x2F;2-64) # x start</span><br><span class=\"line\">            b&#x3D;int(sz1&#x2F;2+64) # x end</span><br><span class=\"line\">            c&#x3D;int(sz2&#x2F;2-64) # y start</span><br><span class=\"line\">            d&#x3D;int(sz2&#x2F;2+64) # y end</span><br><span class=\"line\">            cropImg &#x3D; image[a:b,c:d]   #裁剪图像</span><br><span class=\"line\">            cv2.imwrite(dest,cropImg)  #写入图像路径</span><br></pre></td></tr></table></figure><h1> 批量处理—指定坐标位置的图像截取 </h1><p><strong> 导入相关库 </strong><br><img src=\"http://ww1.sinaimg.cn/large/e92dbddbgy1gh7v54hqvxj20bg04f3yh.jpg\" alt=\"btbgbrt5.png\"><br><strong> 判断图片文件名和 txt 文件名是否一致 </strong><br> 此处只判断 i 和 i+1，如有要求可自行判断所有元素的匹配 <br><img src=\"http://ww1.sinaimg.cn/large/e92dbddbgy1gh7vagzk02j20ms03sdgb.jpg\" alt=\"6cvfv.png\"><br><strong> 逐行读取 txt 文本内容 </strong><br><img src=\"http://ww1.sinaimg.cn/large/e92dbddbgy1gh7vaqlgvoj20ok07ht9s.jpg\" alt=\"7tewerqwdc.png\"><br><strong> 利用 cv2 截取相应坐标图保存指定路径 </strong><br><img src=\"http://ww1.sinaimg.cn/large/e92dbddbgy1gh7vayegdyj20u90203yw.jpg\" alt=\"ewqwe8qwe.png\"></p><h1> 添加多进程多进程（加快处理）</h1><p><strong>在导入前面库后，多导入个 multiprocessing</strong><br><img src=\"http://ww1.sinaimg.cn/large/e92dbddbgy1gh7vhsqzh3j20r00g5q56.jpg\" alt=\"qewe10dcwe.png\"><br><em><strong>详细步骤自度</strong></em></p>","url":"/posts/64/","min2read":1,"word4post":447,"prev_post":null,"next_post":{"title":"网站人机验证 ip","url":"/posts/9/"},"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" data-id=\"\" href = \"#\"><span class=\"toc-number\">1.</span> <span class=\"toc-text\">转化规则 </span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" data-id=\"\" href = \"#\"><span class=\"toc-number\">2.</span> <span class=\"toc-text\"> 指定坐标位置的图像截取 </span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" data-id=\"\" href = \"#\"><span class=\"toc-number\">3.</span> <span class=\"toc-text\"> 批量处理—指定坐标位置的图像截取 </span></a></li><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" data-id=\"\" href = \"#\"><span class=\"toc-number\">4.</span> <span class=\"toc-text\"> 添加多进程多进程（加快处理）</span></a></li></ol>","categories":[{"name":"机器学习","path":"api/categories/机器学习.json","url":"/categories/机器学习/"}],"tags":[{"name":"OpenCV","path":"api/tags/OpenCV.json","url":"/tags/OpenCV/"}]}